**员工请假管理系统**
 
**一、后端源代码结构**
```plaintext
employee_leave_management/
│
├── app/
│   ├── __init__.py
│   ├── main.py  # 启动文件
│   ├── models.py  # 数据库模型
│   ├── schemas.py  # Pydantic模型
│   ├── api/
│   │   ├── __init__.py
│   │   ├── leave_requests.py  # 请假请求API
│   │   └── approvals.py  # 审批API
│   ├── db.py  # 数据库连接
│   └── utils.py  # 工具函数
│
├── tests/
│   ├── __init__.py
│   ├── test_leave_requests.py  # 请假请求测试
│   └── test_approvals.py  # 审批测试
│
├── requirements.txt  # Python依赖包
└── README.md  # 项目文档
```

**二、数据库模型（models.py）**
```python
from sqlalchemy import Column, Integer, String, DateTime, ForeignKey
from sqlalchemy.orm import relationship
from .db import Base

class LeaveRequest(Base):
    __tablename__ = 'leave_requests'
    
    id = Column(Integer, primary_key=True, index=True)
    employee_id = Column(Integer, ForeignKey('users.id'))
    reason = Column(String)
    start_date = Column(DateTime)
    end_date = Column(DateTime)
    status = Column(String, default='pending')  # ['pending', 'approved', 'rejected']

    employee = relationship("User", back_populates="leave_requests")

class User(Base):
    __tablename__ = 'users'
    
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String)
    role = Column(String)  # ['employee', 'manager', 'admin']
    
    leave_requests = relationship("LeaveRequest", back_populates="employee")
```

**三、API接口示例（leave_requests.py）**
```python
from fastapi import APIRouter, Depends
from sqlalchemy.orm import Session
from . import models, schemas
from .db import get_db

router = APIRouter()

@router.post("/requests/", response_model=schemas.LeaveRequest)
def create_leave_request(request: schemas.LeaveRequestCreate, db: Session = Depends(get_db)):
    db_request = models.LeaveRequest(**request.dict())
    db.add(db_request)
    db.commit()
    db.refresh(db_request)
    return db_request

@router.get("/requests/{request_id}", response_model=schemas.LeaveRequest)
def read_leave_request(request_id: int, db: Session = Depends(get_db)):
    return db.query(models.LeaveRequest).filter(models.LeaveRequest.id == request_id).first()
```

**四、API文档（使用FastAPI自动生成）**
- Postman导入API文档进行测试。
- 自动生成的Swagger文档可在 `/docs` 路径下访问。

**五、数据库脚本示例（database_setup.sql）**
```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    role VARCHAR(50) NOT NULL
);

CREATE TABLE leave_requests (
    id SERIAL PRIMARY KEY,
    employee_id INTEGER REFERENCES users(id),
    reason TEXT NOT NULL,
    start_date TIMESTAMP NOT NULL,
    end_date TIMESTAMP NOT NULL,
    status VARCHAR(20) DEFAULT 'pending'
);
```

**六、后端测试用例（test_leave_requests.py）**
```python
from fastapi.testclient import TestClient
from app.main import app

client = TestClient(app)

def test_create_leave_request():
    response = client.post("/requests/", json={"employee_id": 1, "reason": "Sick leave", "start_date": "2023-11-01T10:00:00", "end_date": "2023-11-05T10:00:00"})
    assert response.status_code == 200
    assert response.json()["reason"] == "Sick leave"

def test_read_leave_request():
    response = client.get("/requests/1")
    assert response.status_code == 200
```

**七、部署配置文档**
- 使用Docker构建容器化环境。
- 使用GitHub Actions进行CI/CD自动化部署。

**八、建议使用的工具**
- 使用SQLAlchemy进行数据库操作。
- 使用Pydantic进行数据验证。
- 使用Alembic进行数据库迁移。

通过以上代码结构和文档组成部分，该系统能够高效地实现员工请假管理的核心功能，包括多级审批、权限管理和请假记录查询。这将确保系统的可扩展性、可靠性和安全性。
